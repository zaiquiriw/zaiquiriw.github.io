
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="All things ZaiquiriW" name="description"/>
<meta content="Zachary Canoot" name="author"/>
<link href="https://zaiquiri.github.io/ML%20Work/RegressionSVM/" rel="canonical"/>
<link href="../Regression/" rel="prev"/>
<link href="../data%20exploration/" rel="next"/>
<link href="../../assets/meta/favicons.png" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.4.6" name="generator"/>
<title>Regression with SVM - ZaiquiriW</title>
<link href="../../assets/stylesheets/main.35e1ed30.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.356b1318.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Ubuntu";--md-code-font:"Ubuntu Mono"}</style>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet"/>
<link href="https://cdn.jsdelivr.net/gh/ObsidianPublisher/assets@main/dist/styles.css" rel="stylesheet"/>
<link href="../../assets/css/admonition.css" rel="stylesheet"/>
<link href="../../assets/css/custom_attributes.css" rel="stylesheet"/>
<link href="../../assets/css/customization.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script src="https://unpkg.com/@popperjs/core@2/dist/umd/popper.min.js"></script>
<script src="https://unpkg.com/tippy.js@6/dist/tippy-bundle.umd.js"></script>
<link href="https://unpkg.com/tippy.js@6/animations/scale-subtle.css" rel="stylesheet">
<link href="https://unpkg.com/tippy.js@6/themes/translucent.css" rel="stylesheet">
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" referrerpolicy="no-referrer" rel="stylesheet">
<meta content="summary_large_image" name="twitter:card"/>
<meta content="https://zaiquiri.github.io/assets/meta/SEO.png" property="og:image"/>
<meta content="https://zaiquiri.github.io/assets/meta/SEO.png" name="twitter:image"/>
<meta content="https://zaiquiri.github.io/" name="site_url"/>
<meta content="Regression with SVM" property="og:title"/>
<meta content="Regression with SVM" name="twitter:title"/>
<meta content="All things ZaiquiriW" name="og:description"/>
<meta content="All things ZaiquiriW" name="twitter:description"/>
<script> document.title = "Regression with SVM" </script>
</link></link></link> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="light-blue" data-md-color-primary="teal" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#svm-regression">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="ZaiquiriW" class="md-header__button md-logo" data-md-component="logo" href="../.." title="ZaiquiriW">
<img alt="logo" src="../../assets/meta/favicons.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            ZaiquiriW
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Regression with SVM
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="light-blue" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="teal" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="blue" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../nlp%20overview/">
        
  
    
  
  Nlp overview

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../tags/">
        
  
    
  
  Tags

      </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../Classification/">
          
  
    
  
  ML Work

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../NLP%20Work/summary/">
          
  
    
  
  NLP Work

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../nlp%20overview/">
          
  
    
  
  Nlp overview

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../obsidian/copart%20internship/">
          
  
    
  
  Obsidian

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="ZaiquiriW" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="ZaiquiriW">
<img alt="logo" src="../../assets/meta/favicons.png"/>
</a>
    ZaiquiriW
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../nlp%20overview/">
<span class="md-ellipsis">
    Nlp overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tags/">
<span class="md-ellipsis">
    Tags
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
<span class="md-ellipsis">
    ML Work
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            ML Work
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Classification/">
<span class="md-ellipsis">
    Classification
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Regression/">
<span class="md-ellipsis">
    Regression
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Regression with SVM
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Regression with SVM
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#svm-regression">
    SVM Regression
  </a>
<nav aria-label="SVM Regression" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#exploring-our-data">
    Exploring our Data
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#graphical-and-text-analysis">
    Graphical and Text Analysis
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performing-svm-regression">
    Performing SVM Regression
  </a>
<nav aria-label="Performing SVM Regression" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#linear-kernel">
    Linear Kernel
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#polynomial-kernel">
    Polynomial Kernel
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#radial-kernel">
    Radial Kernel
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#analysis">
    Analysis
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#link-dump">
    Link Dump!
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../data%20exploration/">
<span class="md-ellipsis">
    Data exploration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ml%20overview/">
<span class="md-ellipsis">
    ML Work
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
<span class="md-ellipsis">
    NLP Work
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            NLP Work
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../NLP%20Work/summary/">
<span class="md-ellipsis">
    Summary
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../nlp%20overview/">
<span class="md-ellipsis">
    Nlp overview
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Nlp overview
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
<span class="md-ellipsis">
    Obsidian
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Obsidian
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../obsidian/copart%20internship/">
<span class="md-ellipsis">
    Copart internship
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../obsidian/portfolio%20cleanup/">
<span class="md-ellipsis">
    Portfolio cleanup
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#svm-regression">
    SVM Regression
  </a>
<nav aria-label="SVM Regression" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#exploring-our-data">
    Exploring our Data
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#graphical-and-text-analysis">
    Graphical and Text Analysis
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performing-svm-regression">
    Performing SVM Regression
  </a>
<nav aria-label="Performing SVM Regression" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#linear-kernel">
    Linear Kernel
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#polynomial-kernel">
    Polynomial Kernel
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#radial-kernel">
    Radial Kernel
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#analysis">
    Analysis
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#link-dump">
    Link Dump!
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<!--
  Copyright (c) 2016-2023 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Tags -->
<nav class="md-tags">
</nav>
<!-- Actions -->
<!--
  Hack: check whether the content contains a h1 headline. If it doesn't, the
  page title (or respectively site name) is used as the main headline.
-->
<h1>Regression with SVM</h1>
<!-- Page content -->
<h2 id="svm-regression">SVM Regression<a class="headerlink" href="#svm-regression" title="Permanent link">¶</a></h2>
<p>Support Vector Machines can divide data into classes by a hyperplane in<br/>
multidimensional space. This line separates classes by finding minimum distance<br/>
of margins between support vectors. Once we calculate support vectors for our<br/>
model (given an input of slack in the margins optimized with validation data),<br/>
we can then classify the data in relation to the margins on the hyperplane.</p>
<p>In the case of Regression, we apply this logic to fit a line to the data (as<br/>
opposed to divide the data). Classification minimizes the margins such that all<br/>
examples on either side of the margins are assumed to be classified correctly.<br/>
SVM Regression’s minimization function will instead find a hyper plane that fits<br/>
the data within a certain accuracy. Specifically, the support vectors have the<br/>
largest amount of error (distance) from the hyperplane, and everything within<br/>
those support vectors (the margin) is assumed correctly fitted. Thus the<br/>
hyperplane fits the data like simple regression.</p>
<p>We are going to apply this algorithm to a simple 1 target, 1 predictor data set,<br/>
and get a nice visual demonstration of the hyperplane.</p>
<h3 id="exploring-our-data">Exploring our Data<a class="headerlink" href="#exploring-our-data" title="Permanent link">¶</a></h3>
<p>Our data, found on <a href="https://www.kaggle.com/datasets/sohier/calcofi">Kaggle</a> is a<br/>
very detailed and large collection of samples of larval fish data. However, I’m<br/>
only interested in the temperature of the ocean water in relation to it’s<br/>
salinity. So lets read it in and trim it down to just the necessary columns and<br/>
a handleable training size. After finishing the document, I realized I had to<br/>
trim the file size for github, so note that the actual data on kaggle is much<br/>
larger!</p>
<blockquote>
<p>Note: We are going to sample the data to a smaller size right now, knowing<br/>
that the last slide for SVM warned this may be neccessary</p>
</blockquote>
<p>We think it is worth leaving depth in, sense this will probably be a good<br/>
predictor of temperature, if not as easy to see visually.</p>
<blockquote>
<p>I’m leaving in the 2 code chunks below as comments, but they are referring to<br/>
data <em>before</em> I trimmed down the csv file to upload to github!</p>
</blockquote>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1"># This takes a second</span>
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="c1"># ocean_data &lt;- read.csv("bottle.csv")</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1"># Selecting the wanted columns: 5= T_degC, 6=Depthm, and 7=Salnty</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="c1"># df &lt;- ocean_data[c(5,6,7)]</span>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="c1"># Removing NAs</span>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="c1"># which_nas &lt;- apply(df, 1, function(X) any(is.na(X)))</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="c1"># nas &lt;- length(which(which_nas))</span>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="c1"># size &lt;- nrow(df)</span>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="c1"># ratio &lt;- nas/size</span>
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="c1"># size &lt;- format(size, big.mark = ",", scientific = FALSE)</span>
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="c1"># nas &lt;- format(length(which(which_nas)), big.mark = ",", scientific = FALSE)</span>
<a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="c1"># sprintf("%%%.2f of the %s large dataset contains NA's. Removing %s", ratio*100, size, nas)</span>
<a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="c1"># df &lt;- na.omit(df)</span>
</code></pre></div>
<p>864,863 rows! That’s still quite large! Lets reduce to exactly 10,000</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1"># set.seed(8)</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="c1"># df &lt;- df[sample(1:nrow(df),10000,replace=FALSE),]</span>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="c1"># nrow(df)</span>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="c1"># head(df)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1"># write.csv(df,"ocean_data.csv")</span>
</code></pre></div>
<p>We can then split into training, testing, and validation data</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1"># The line below reads in the modified csv</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="nf">set.seed</span><span class="p">(</span><span class="m">8</span><span class="p">)</span>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">"ocean_data.csv"</span><span class="p">)</span>
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="n">spec</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">train</span><span class="o">=</span><span class="n">.</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="o">=</span><span class="n">.</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">validate</span><span class="o">=</span><span class="n">.</span><span class="m">2</span><span class="p">)</span>
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="n">i</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="nf">cut</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">df</span><span class="p">),</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">*</span><span class="nf">cumsum</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">spec</span><span class="p">)),</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">names</span><span class="p">(</span><span class="n">spec</span><span class="p">)))</span>
<a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="o">==</span><span class="s">"train"</span><span class="p">,]</span>
<a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="o">==</span><span class="s">"test"</span><span class="p">,]</span>
<a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="n">vald</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="o">==</span><span class="s">"validate"</span><span class="p">,]</span>
</code></pre></div>
<h2 id="graphical-and-text-analysis">Graphical and Text Analysis<a class="headerlink" href="#graphical-and-text-analysis" title="Permanent link">¶</a></h2>
<p>Lets look at the data we are using to build our models:</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="nf">summary</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
</code></pre></div>
<p>Some things to note:</p>
<ol>
<li>A min depth of 0 is odd, but makes sense as a surface reading</li>
<li>The outliers don’t seem that far, so this might be some good data to look at</li>
<li>From the mean values we can gather our average case: At a depth of of 228<br/>
    meters, the temperature was ~11 degrees Celsius (51.8 Fahrenheit), with a<br/>
    Salinity of ~34 percent, which matches averages easily found online.</li>
<li>There weren’t that many data reads in extremely salty waters (&gt;36%)</li>
</ol>
<p>I want to graph the correlation from salinity to temperature, a 3d graph of<br/>
depth, temperature, and salinity, etc.</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="nf">theme_set</span><span class="p">(</span><span class="nf">theme_minimal</span><span class="p">())</span>
<a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="n">mid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">train</span><span class="o">$</span><span class="n">Depthm</span><span class="p">)</span>
<a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="nf">ggplot</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Salnty</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">T_degC</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Depthm</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">  </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s">"y~x"</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s">"lm"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Salinity vs Temperature"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s">"Salinity (Percentage)"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span>
<a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="w">       </span><span class="o">=</span><span class="s">"Temperature (C)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="w">  </span><span class="nf">scale_color_gradient2</span><span class="p">(</span><span class="n">midpoint</span><span class="o">=</span><span class="n">mid</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"lab"</span><span class="p">)</span>
<a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a>
<a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="nf">ggplot</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Depthm</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">T_degC</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Salnty</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="w">  </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s">"y~x"</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s">"lm"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<a href="#__codelineno-6-14" id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Depth vs Temperature"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s">"Depth (Meters)"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span>
<a href="#__codelineno-6-15" id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="w">       </span><span class="o">=</span><span class="s">"Temperature (C)"</span><span class="p">)</span>
</code></pre></div>
<p>We can see by this scatter plot, along with the convenient smoothing line that<br/>
there is definitely a trend or correlation in the data. The smoothing line shows<br/>
what the result of a linear regression might be on the model, and it’s<br/>
confidence interval (indicated by the gray border on the line) indicates the<br/>
model… holds some water.</p>
<p>Both Depth and Salinity have a strong correlation, but it seems Depth might have<br/>
an exponential decay like relationship with temperature. That makes me wonder<br/>
how the best way to portray these relationships.</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="nf">cor</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</code></pre></div>
<p>Looking at the correlation as well as our graphs, simple visual analysis tells<br/>
us that both depth and salinity are useful predictors of temperature, and a<br/>
linear regression model would be useful. However, the relationships are complex,<br/>
and we may find that a SVM regression model with a polynomial kernel might yield<br/>
a good result. This is because it would be able to mold together our 2<br/>
predictors.</p>
<p>Lets have a multiple-predictor linear regression model to compare our SVM<br/>
results to and then carry on.</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="c1"># Creating a lm using both predictors and graphing predictions</span>
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="n">lm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">T_degC</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Salnty</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Depthm</span><span class="p">,</span><span class="w"> </span><span class="n">train</span><span class="p">)</span>
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="n">pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">lm</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
<a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="n">preddf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">temp_pred</span><span class="o">=</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">salinity</span><span class="o">=</span><span class="n">test</span><span class="o">$</span><span class="n">Salnty</span><span class="p">)</span>
<a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="nf">summary</span><span class="p">(</span><span class="n">lm</span><span class="p">)</span>
<a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="n">cor</span><span class="w"> </span><span class="o">&lt;-</span><span class="nf">cor</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">T_degC</span><span class="p">)</span>
<a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="n">mse</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">((</span><span class="n">pred</span><span class="o">-</span><span class="n">test</span><span class="o">$</span><span class="n">T_degC</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Correlation of our prediction: %s"</span><span class="p">,</span><span class="w"> </span><span class="n">cor</span><span class="p">)</span>
<a href="#__codelineno-8-9" id="__codelineno-8-9" name="__codelineno-8-9"></a><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Mean Squared Error: %s"</span><span class="p">,</span><span class="w"> </span><span class="n">mse</span><span class="p">)</span>
<a href="#__codelineno-8-10" id="__codelineno-8-10" name="__codelineno-8-10"></a>
<a href="#__codelineno-8-11" id="__codelineno-8-11" name="__codelineno-8-11"></a><span class="nf">ggplot</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Salnty</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">T_degC</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<a href="#__codelineno-8-12" id="__codelineno-8-12" name="__codelineno-8-12"></a><span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Depthm</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<a href="#__codelineno-8-13" id="__codelineno-8-13" name="__codelineno-8-13"></a><span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">pch</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">"yellow"</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">preddf</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">salinity</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">temp_pred</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="n">.</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<a href="#__codelineno-8-14" id="__codelineno-8-14" name="__codelineno-8-14"></a><span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Salinity vs Temperature"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s">"Salinity (Percentage)"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span>
<a href="#__codelineno-8-15" id="__codelineno-8-15" name="__codelineno-8-15"></a><span class="w">       </span><span class="o">=</span><span class="s">"Temperature (C)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<a href="#__codelineno-8-16" id="__codelineno-8-16" name="__codelineno-8-16"></a><span class="w">  </span><span class="nf">scale_color_gradient2</span><span class="p">(</span><span class="n">midpoint</span><span class="o">=</span><span class="n">mid</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"lab"</span><span class="p">)</span>
</code></pre></div>
<h2 id="performing-svm-regression">Performing SVM Regression<a class="headerlink" href="#performing-svm-regression" title="Permanent link">¶</a></h2>
<p>Lets just create a model for each type, tune the hyperparameters, and analyze<br/>
the results.</p>
<h3 id="linear-kernel">Linear Kernel<a class="headerlink" href="#linear-kernel" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="nf">library</span><span class="p">(</span><span class="n">e1071</span><span class="p">)</span>
<a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="n">svmlin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">svm</span><span class="p">(</span><span class="n">T_degC</span><span class="o">~</span><span class="n">Depthm</span><span class="o">+</span><span class="n">Salnty</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="o">=</span><span class="s">"linear"</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="nf">summary</span><span class="p">(</span><span class="n">svmlin</span><span class="p">)</span>
<a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="n">pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">svmlin</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
<a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="n">cor_svmlin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cor</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">T_degC</span><span class="p">)</span>
<a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="n">mse_svmlin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">((</span><span class="n">pred</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">T_degC</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Correlation of our prediction: %s"</span><span class="p">,</span><span class="w"> </span><span class="n">cor_svmlin</span><span class="p">)</span>
<a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Mean Squared Error: %s"</span><span class="p">,</span><span class="w"> </span><span class="n">mse_svmlin</span><span class="p">)</span>
</code></pre></div>
<p>That is a little worse then our baseline, lets try and tune it using a smaller<br/>
subsample</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="c1"># Just using the ranges used in examples</span>
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="n">tune_svmlin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tune</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span><span class="w"> </span><span class="n">T_degC</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Depthm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Salnty</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vald</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="o">=</span><span class="s">"linear"</span><span class="p">,</span><span class="w"> </span><span class="n">ranges</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">cost</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.001</span><span class="p">,</span><span class="w"> </span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">)))</span>
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="n">tune_svmlin</span><span class="o">$</span><span class="n">best.model</span>
</code></pre></div>
<p>We ran it with 1000 rows, and got a cost value of 1, then ran it with 3000 and<br/>
got 100, then ran it with 5000, and then decided to wait for the 10000 to finish<br/>
and got.. well 100. This suggest I should increase the range, but also that the<br/>
linear model isn’t the best solution to our data, considering the cost had to be<br/>
so high.</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">svmlin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">svm</span><span class="p">(</span><span class="n">T_degC</span><span class="o">~</span><span class="n">Depthm</span><span class="o">+</span><span class="n">Salnty</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="o">=</span><span class="s">"linear"</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="n">pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">svmlin</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
<a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="n">tuned_cor_svmlin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cor</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">T_degC</span><span class="p">)</span>
<a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="n">tuned_mse_svmlin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">((</span><span class="n">pred</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">T_degC</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Correlation of our prediction: %s"</span><span class="p">,</span><span class="w"> </span><span class="n">tuned_cor_svmlin</span><span class="p">)</span>
<a href="#__codelineno-11-6" id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Mean Squared Error: %s"</span><span class="p">,</span><span class="w"> </span><span class="n">tuned_mse_svmlin</span><span class="p">)</span>
</code></pre></div>
<p>The error was higher, and the correlation was lower so we didn’t improve. Tuning<br/>
also barely effected the results!</p>
<h3 id="polynomial-kernel">Polynomial Kernel<a class="headerlink" href="#polynomial-kernel" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="n">svmpoly</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">svm</span><span class="p">(</span><span class="n">T_degC</span><span class="o">~</span><span class="n">Depthm</span><span class="o">+</span><span class="n">Salnty</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="o">=</span><span class="s">"polynomial"</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="nf">summary</span><span class="p">(</span><span class="n">svmpoly</span><span class="p">)</span>
<a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="n">pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">svmpoly</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
<a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="n">cor_svmpoly</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cor</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">T_degC</span><span class="p">)</span>
<a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="n">mse_svmpoly</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">((</span><span class="n">pred</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">T_degC</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<a href="#__codelineno-12-6" id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Correlation of our prediction: %s"</span><span class="p">,</span><span class="w"> </span><span class="n">cor_svmpoly</span><span class="p">)</span>
<a href="#__codelineno-12-7" id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Mean Squared Error: %s"</span><span class="p">,</span><span class="w"> </span><span class="n">mse_svmpoly</span><span class="p">)</span>
</code></pre></div>
<p>Well that didn’t go well! MSE is even higher then the baseline, so I can try to<br/>
tune</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="c1"># tune_svmpoly &lt;- tune(svm, T_degC ~ Depthm + Salnty, data = vald, kernel="polynomial", ranges=list(cost=c(0.001, 0.01, 0.1, # 1, 5, 10, 100)))</span>
<a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="c1"># tune_svmlin$best.model</span>
</code></pre></div>
<p>This would take a while to run, but would simply keep trying to increase the<br/>
cost. But then that produces a model that over fits the training data! It seems<br/>
this simply isn’t the best way to fit this data and is a bit worse then simple<br/>
regression.</p>
<h3 id="radial-kernel">Radial Kernel<a class="headerlink" href="#radial-kernel" title="Permanent link">¶</a></h3>
<p>My only hope…</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="n">svmrad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">svm</span><span class="p">(</span><span class="n">T_degC</span><span class="o">~</span><span class="n">Depthm</span><span class="o">+</span><span class="n">Salnty</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="o">=</span><span class="s">"radial"</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">gamma</span><span class="o">=</span><span class="n">.</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="nf">summary</span><span class="p">(</span><span class="n">svmrad</span><span class="p">)</span>
<a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="n">pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">svmrad</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
<a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="n">cor_svmrad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cor</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">T_degC</span><span class="p">)</span>
<a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="n">mse_svmrad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">((</span><span class="n">pred</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">T_degC</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<a href="#__codelineno-14-6" id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Correlation of our prediction: %s"</span><span class="p">,</span><span class="w"> </span><span class="n">cor_svmrad</span><span class="p">)</span>
<a href="#__codelineno-14-7" id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Mean Squared Error: %s"</span><span class="p">,</span><span class="w"> </span><span class="n">mse_svmrad</span><span class="p">)</span>
</code></pre></div>
<p>WOAH. What a great result! That is a good correlation, and what seems to be a<br/>
pretty good MSE, and both are much better then our baseline linear regression.<br/>
Lets try and tune</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="n">tune_svmrad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tune</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span><span class="w"> </span><span class="n">T_degC</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Depthm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Salnty</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vald</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="o">=</span><span class="s">"radial"</span><span class="p">,</span><span class="w"> </span><span class="n">ranges</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">cost</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.001</span><span class="p">,</span><span class="w"> </span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">),</span><span class="w"> </span><span class="n">gamma</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">)))</span>
<a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="n">tune_svmrad</span><span class="o">$</span><span class="n">best.model</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="n">svmrad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">svm</span><span class="p">(</span><span class="n">T_degC</span><span class="o">~</span><span class="n">Depthm</span><span class="o">+</span><span class="n">Salnty</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">,</span><span class="w"> </span><span class="n">kernel</span><span class="o">=</span><span class="s">"radial"</span><span class="p">,</span><span class="w"> </span><span class="n">cost</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">gamma</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="n">pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">svmrad</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="o">=</span><span class="n">test</span><span class="p">)</span>
<a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="n">cor_svmrad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cor</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">T_degC</span><span class="p">)</span>
<a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="n">mse_svmrad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">((</span><span class="n">pred</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">test</span><span class="o">$</span><span class="n">T_degC</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Correlation of our prediction: %s"</span><span class="p">,</span><span class="w"> </span><span class="n">cor_svmrad</span><span class="p">)</span>
<a href="#__codelineno-16-6" id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="nf">sprintf</span><span class="p">(</span><span class="s">"Mean Squared Error: %s"</span><span class="p">,</span><span class="w"> </span><span class="n">mse_svmrad</span><span class="p">)</span>
</code></pre></div>
<p>It made the results a bit marginally worse, which suggests over fitting of the<br/>
data with the training data vs the validation data.</p>
<p>Either way, good results! Lets graph it!</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="n">preddf2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">temp_pred</span><span class="o">=</span><span class="n">pred</span><span class="p">,</span><span class="w"> </span><span class="n">salinity</span><span class="o">=</span><span class="n">test</span><span class="o">$</span><span class="n">Salnty</span><span class="p">)</span>
<a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a>
<a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="nf">ggplot</span><span class="p">(</span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Salnty</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">T_degC</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">pch</span><span class="o">=</span><span class="m">19</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Depthm</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">pch</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">"green"</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">preddf2</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">salinity</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">temp_pred</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="n">.</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">pch</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">"yellow"</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">preddf</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">salinity</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">temp_pred</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="n">.</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<a href="#__codelineno-17-7" id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="w">  </span><span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">"Salinity vs Temperature"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="s">"Salinity (Percentage)"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span>
<a href="#__codelineno-17-8" id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="w">       </span><span class="o">=</span><span class="s">"Temperature (C)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<a href="#__codelineno-17-9" id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="w">  </span><span class="nf">scale_color_gradient2</span><span class="p">(</span><span class="n">midpoint</span><span class="o">=</span><span class="n">mid</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"blue"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"lab"</span><span class="p">)</span>
</code></pre></div>
<p>The green points indicate our new Just a bit lower then our linear regression<br/>
model at the start, which suggests less susceptibility to outliers.</p>
<h2 id="analysis">Analysis<a class="headerlink" href="#analysis" title="Permanent link">¶</a></h2>
<p>I would love to visualize the radial kernel to get an idea for how it works on<br/>
this data, but quoting StatQuest: “Because the Radial Kernel finds Support<br/>
Vector Classifiers in infinite dimensions, it’s not possible to visualize what<br/>
it does”. While I know that you can still get an approximation, I’m going to go<br/>
ahead and skip figuring out how to do that for now.</p>
<p>The main topic to analyze here is why the radial kernel was better than the<br/>
polynomial or the linear kernel. Each kernel represents a different method of<br/>
transforming the data so that a hyperplane may divide the data, or in this case,<br/>
fit a function.</p>
<ul>
<li>
<p>The linear kernel is simple, it fits a hyperplane to the data</p>
</li>
<li>
<p>The polynomial kernel transforms the data in such a way to mimic adding more<br/>
    features to the data set, really just by mapping the input data to a<br/>
    polynomial of a higher degree. By mapping values in a higher degree space,<br/>
    say, to the second degree, what really is a circular data set classification<br/>
    can now have a straight line drawn through it.</p>
</li>
<li>
<p>The radial kernel compares the distance between every 2 values in the input<br/>
    data, and scales the data by the value of it’s distance. This mimics nearest<br/>
    neighbor, where the model predicts every value with increasing weight<br/>
    supplied to its neighbors. The kernel can then map the input to a higher<br/>
    (infinite) dimensional space where it is easiest to fit a hyperplane that<br/>
    best maximizes the margins of the model… it’s not exactly easy to wrap a<br/>
    brain around</p>
</li>
</ul>
<p>Because we found in our initial analysis that the relationship between our two<br/>
predictors and our target was a complicated combination of a a not-so-linear<br/>
relationship and a perhaps-exponential relationship, it makes sense that a<br/>
complicated model like SVM with a radial kernel would have been able to find<br/>
better results</p>
<p>To think of this in terms of the data, the radial kernel was best able to<br/>
interpret how depth related to temperature compared to salinity. As depth<br/>
increased, it got colder, and salinity mattered less. The interactions between<br/>
the data were important in this data! So while linear regression was good at<br/>
approximating the relationship, the radial kernel was <em>probably</em> able to better<br/>
fit the data.</p>
<h2 id="link-dump">Link Dump!<a class="headerlink" href="#link-dump" title="Permanent link">¶</a></h2>
<p><a href="https://stackoverflow.com/questions/13353213/gradient-of-n-colors-ranging-from-color-1-and-color-2">https://stackoverflow.com/questions/13353213/gradient-of-n-colors-ranging-from-color-1-and-color-2</a></p>
<p><a href="https://statisticsglobe.com/sprintf-r-function-example">https://statisticsglobe.com/sprintf-r-function-example</a></p>
<p><a href="https://statisticsglobe.com/display-large-numbers-separated-with-comma-in-r">https://statisticsglobe.com/display-large-numbers-separated-with-comma-in-r</a></p>
<p>I referenced the book for a lot of ggplot2 stuff, as well as code on SVM.</p>
<p><a href="https://www.youtube.com/watch?v=OpPBhBQA7fE&amp;list=PLfe6IcA_dEWkcHFfBA6XSXW31H8t4XSbB&amp;index=16">https://www.youtube.com/watch?v=OpPBhBQA7fE&amp;list=PLfe6IcA_dEWkcHFfBA6XSXW31H8t4XSbB&amp;index=16</a></p>
<p><a href="https://stackoverflow.com/questions/37329074/geom-smooth-and-exponential-fits">https://stackoverflow.com/questions/37329074/geom-smooth-and-exponential-fits</a></p>
<p><a href="https://machinelearningmastery.com/regression-metrics-for-machine-learning/">https://machinelearningmastery.com/regression-metrics-for-machine-learning/</a></p>
<p><a href="https://www.youtube.com/watch?v=Qc5IyLW_hns">https://www.youtube.com/watch?v=Qc5IyLW_hns</a></p>
<!-- Source file information -->
<!-- taken from 
https://github.com/squidfunk/mkdocs-material/blob/master/src/partials/source-file.html -->
<hr/>
<div class="md-source-file">
<small>
<!-- mkdocs-git-revision-date-localized-plugin -->
<u>Last update</u> :
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">25 octobre 2023</span>
<!-- mkdocs-git-revision-date-plugin -->
<br/>
<u>Created</u> :
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">25 octobre 2023</span>
<br/>
<u>Auteur</u> : Zachary Canoot
        
        
    </small>
</div>
<!-- Was this page helpful? -->
<!-- Comment system -->
<!-- Giscus -->
<!-- Giscus -->
<script> 
    try {
      const index = document.querySelector('h1').innerHTML;
      if (index === "Index") {
        document.querySelector('h1').innerHTML = "Regression with SVM";
      }
    } catch (error) {
      // console.log(error);
    }
  </script>
</article>
</div>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/ObsidianPublisher/assets@main/dist/javascript.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>